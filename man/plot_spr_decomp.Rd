% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spr_outputs.R
\name{plot_spr_decomp}
\alias{plot_spr_decomp}
\title{Plot SPR diagnostics, SBPR age decompositions}
\usage{
plot_spr_decomp(
  spr_out,
  species = NULL,
  drop_plus_from_plot = TRUE,
  include_plus_caption = TRUE,
  which_panels = c("contrib", "removed", "survivorship")
)
}
\arguments{
\item{spr_out}{Output list from \code{run_spr()} with \code{diagnostics = TRUE}.}

\item{species}{Character vector of species to include. Defaults to all
species in \code{spr_out}.}

\item{drop_plus_from_plot}{Logical. If TRUE (default), drops the terminal age from the
plotted panels (only when plus-group diagnostics are available).}

\item{include_plus_caption}{Logical. If TRUE (default), adds the plus-group share
caption to \code{plots$contrib} when available.}

\item{which_panels}{Character vector, any of \code{c("contrib", "removed",
"removed_prop", "survivorship")}.}
}
\value{
A named list of ggplot objects. A compact summary table is attached as
\code{attr(out, "summary")}.
}
\description{
Creates report-ready diagnostic plots of age-specific decompositions of
spawning biomass per recruit (SBPR) under unfished conditions (F = 0) and at
a reference fishing mortality (F = Ftarget) chosen by \code{run_spr()}
(default = F40).
}
\details{
Returned object is a named list of ggplot objects:
\itemize{
\item \code{plots$contrib}: SBPR contribution by age, comparing F0 vs Ftarget.
\item \code{plots$removed}: SBPR removed by fishing at each age (F0 - Ftarget).
\item \code{plots$removed_prop}: (not shown by default) SBPR removed by
fishing at each age, normalized to the species' total unfished SBPR (F0).
Useful for multispecies applications to compare fractional losses among
species when absolute SBPR magnitudes differ.
\item \code{plots$survivorship}: survivorship by age (per recruit), F0 vs Ftarget.
}

Plus-group treatment can strongly influence SBPR, especially for long-lived
species. When \code{drop_plus_from_plot = TRUE} (default), the terminal age
is excluded from the plots to avoid dominance by the plus group, while the
fraction of total SBPR attributable to the terminal age is retained in
\code{spr_out$diagnostics$plus_share} and can be appended as a plot caption.

\strong{Summary table.} The function also attaches a compact per-species summary table
(unfished SBPR, SBPR at Ftarget, implied SPR at Ftarget, and plus-group shares when available)
as \code{attr(plots, "summary")}.
}
\examples{
\dontrun{
spr_out <- run_spr(inp, diagnostics = TRUE,
                  multispecies_constraint = "all_species")

# Default panels
plots <- plot_spr_decomp(spr_out, drop_plus_from_plot = TRUE)
plots$contrib
plots$removed
plots$survivorship

# Summary table for optional reporting
attr(plots, "summary")
}

}
