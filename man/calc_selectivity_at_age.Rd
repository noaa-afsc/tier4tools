% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spr_inputs.R
\name{calc_selectivity_at_age}
\alias{calc_selectivity_at_age}
\title{Fishery selectivity-at-age}
\usage{
calc_selectivity_at_age(ages, selectivity, scale_max = TRUE)
}
\arguments{
\item{ages}{Numeric vector of ages (e.g., \code{a_min:a_max}).}

\item{selectivity}{A named list specifying selectivity. Required element \code{type}.
For \code{type="vector"}, provide \code{s}. For \code{type="knife_edge"}, provide \code{a_c}.
For \code{type="logistic"}, provide \code{a50} and \code{delta}.
For \code{type="fleets"}, provide \code{fleets}, a named list of fleets. Each fleet must include
\code{propF} (nonnegative, used as a weight on \eqn{F}) and \code{selex} (a selectivity specification of
type \code{"vector"}, \code{"knife_edge"}, or \code{"logistic"}).}

\item{scale_max}{Logical. If \code{TRUE}, scales selectivity so that \code{max(s_a) = 1} when possible.}
}
\value{
Numeric vector \code{selectivity_at_age} with \code{length(ages)}.
}
\description{
Convert a user-specified selectivity specification into an age-specific vector
spanning the full age range \code{ages = a_min:a_max}. Selectivity is
bounded to \eqn{[0, 1]} and may optionally be scaled so that \code{max(s_a) = 1}.
}
\details{
Supported inputs:
\itemize{
\item \code{type = "vector"}: external selectivity vector \code{s} with \code{length(s) == length(ages)}.
\item \code{type = "knife_edge"}: step function with age-at-full-selection \code{a_c}.
\item \code{type = "logistic"}: logistic curve with parameters \code{a50} and \code{delta}.
\item \code{type = "fleets"}: multiple fisheries with fleet-specific selectivity curves and fishing mortality weights.
Provide \code{fleets = list(<fleetname> = list(propF = <weight>, selex = <selectivity_spec>), ...)}.
Fleet selectivities are collapsed into an effective selectivity-at-age vector using a \code{propF}-weighted mean.
}

Knife-edge form:
\deqn{s_a = 0 \text{ for } a < a_c,\quad s_a = 1 \text{ for } a \ge a_c}

Logistic form:
\deqn{s_a = \frac{1}{1 + \exp\left(\frac{a - a_{50}}{\delta}\right)}}

Multi-fleet option:
When \code{type="fleets"}, the function returns an effective selectivity-at-age vector
\eqn{s^\*a = \sum_f \lambda_f s{f,a}}, where \eqn{\lambda_f} are the normalized \code{propF} weights.
}
\keyword{internal}
