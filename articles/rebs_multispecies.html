<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multispecies Tier 4 workflow: Gulf of Alaska rougheye and blackspotted rockfish (RE/BS) complex • tier4tools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multispecies Tier 4 workflow: Gulf of Alaska rougheye and blackspotted rockfish (RE/BS) complex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tier4tools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multispecies Tier 4 workflow: Gulf of Alaska rougheye and blackspotted rockfish (RE/BS) complex</h1>
            
      

      <div class="d-none name"><code>rebs_multispecies.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tier4tools</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background-and-objectives">Background and objectives<a class="anchor" aria-label="anchor" href="#background-and-objectives"></a>
</h2>
<p>This vignette demonstrates a multispecies Tier 4 workflow using the
Gulf of Alaska rougheye and blackspotted (RE/BS) rockfish complex as a
case study.</p>
<p>The objective is to show when multispecies Tier 4 methods are
informative, how they are implemented in <strong>tier4tools</strong>,
and how results and uncertainty can be communicated using standardized,
SAFE-ready figures. Emphasis is placed on interpretation, rather than
reproducing similar plots under multiple parameterizations.</p>
<div class="section level3">
<h3 id="why-a-multispecies-tier-4-case-study-for-rebs">Why a multispecies Tier 4 case study for RE/BS<a class="anchor" aria-label="anchor" href="#why-a-multispecies-tier-4-case-study-for-rebs"></a>
</h3>
<p>Since 2008, the RE/BS complex has been assessed using a Tier 3
statistical catch-at-age model that combines rougheye and blackspotted
rockfish into a single assessment unit with shared growth, maturity, and
other biological processes. Persistent challenges, including model
scaling, data fits, retrospective patterns, and the need to reconcile
the two species’ distinct life histories, have highlighted limitations
of this combined approach. Conservation concerns have increased in
recent years as complex-level survey biomass has declined, particularly
for blackspotted rockfish, a species with slower growth and later
maturation that is expected to be less resilient to fishing
pressure.</p>
<p>A single-species Tier 4 approach would require reliable,
species-specific biomass or abundance indices to support catch
allocation and scaling. In practice, species separation in the survey
time series is limited, and field identifications are known to be
imperfect based on genetic validation studies. Under these constraints,
a multispecies Tier 4 per recruit model provides a transparent
alternative for exploring how differences in life history and
uncertainty in recruitment composition affect spawning potential ratio
(SPR) reference points and the implied yield-per-recruit (YPR) for each
species.</p>
</div>
<div class="section level3">
<h3 id="what-is-being-varied-in-this-vignette">What is being varied in this vignette<a class="anchor" aria-label="anchor" href="#what-is-being-varied-in-this-vignette"></a>
</h3>
<p>This vignette focuses on two sources of uncertainty that are specific
to multispecies Tier 4 applications:</p>
<p><strong>Definition of multispecies reference points</strong> Two
alternative approaches are evaluated.</p>
<ol style="list-style-type: decimal">
<li><p><em>Unconstrained total curve</em>: The complex-level SPR curve
is computed by summing species-specific SBPR across species, and the
fishing mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
corresponding to a target SPR is identified on this combined
curve.</p></li>
<li><p><em>Constrained approach (all species must meet the target)</em>:
The reference
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
is defined as the maximum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
at which each species meets the target SPR, and the combined curve also
satisfies the target.</p></li>
</ol>
<p>These approaches can yield different reference points when species
differ substantially in productivity.</p>
<p><strong>Recruitment proportions (R0 proportions)</strong></p>
<p>Recruitment proportions determine how each species contributes to
total spawning biomass per recruit (SBPR) and total YPR in the
multispecies complex. Because recruitment composition is uncertain for
the RE/BS complex, sensitivity analyses are conducted across a range of
assumed proportions.</p>
<p>This sensitivity is implemented for two-species complexes only in
<strong>tier4tools</strong>. The analysis is defined by the proportion
assigned to the first species, with the second species receiving the
remainder.</p>
</div>
</div>
<div class="section level2">
<h2 id="life-history-and-fishery-inputs">Life history and fishery inputs<a class="anchor" aria-label="anchor" href="#life-history-and-fishery-inputs"></a>
</h2>
<p>The RE/BS case study uses ages 3 through 52, with a plus group at age
52 for both species. Growth is represented using von Bertalanffy
length-at-age models and weight–length relationships estimated from
fisheries-independent, genetically verified data. Maturity is modeled
using species-specific functional maturity schedules that account for
skipped spawning.</p>
<p>Fishery selectivity is based on the most recent Tier 3 statistical
catch-at-age assessment and is assumed to be identical for both species.
Selectivity is therefore represented by a fixed selectivity-at-age
vector applied consistently across species.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">:</span><span class="fl">52</span></span>
<span><span class="va">use_plus_group</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># Recruitment proportions, base case is 50/50</span></span>
<span><span class="va">rec_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>RE <span class="op">=</span> <span class="fl">0.5</span>, BS <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Natural mortality (assumed identical for both species)</span></span>
<span><span class="va">M_val</span> <span class="op">&lt;-</span> <span class="fl">0.042</span></span>
<span></span>
<span><span class="co"># Functional maturity-at-age vectors (ages 3-52)</span></span>
<span><span class="va">maturity_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.004</span>, <span class="fl">0.003</span>, <span class="fl">0.003</span>, <span class="fl">0.003</span>, <span class="fl">0.003</span>, <span class="fl">0.004</span>, <span class="fl">0.005</span>, <span class="fl">0.009</span>, <span class="fl">0.017</span>, <span class="fl">0.037</span>,</span>
<span>  <span class="fl">0.085</span>, <span class="fl">0.175</span>, <span class="fl">0.297</span>, <span class="fl">0.412</span>, <span class="fl">0.503</span>, <span class="fl">0.569</span>, <span class="fl">0.616</span>, <span class="fl">0.649</span>, <span class="fl">0.672</span>, <span class="fl">0.688</span>,</span>
<span>  <span class="fl">0.699</span>, <span class="fl">0.705</span>, <span class="fl">0.708</span>, <span class="fl">0.708</span>, <span class="fl">0.707</span>, <span class="fl">0.705</span>, <span class="fl">0.702</span>, <span class="fl">0.698</span>, <span class="fl">0.693</span>, <span class="fl">0.688</span>,</span>
<span>  <span class="fl">0.683</span>, <span class="fl">0.677</span>, <span class="fl">0.671</span>, <span class="fl">0.664</span>, <span class="fl">0.658</span>, <span class="fl">0.651</span>, <span class="fl">0.644</span>, <span class="fl">0.637</span>, <span class="fl">0.630</span>, <span class="fl">0.622</span>,</span>
<span>  <span class="fl">0.615</span>, <span class="fl">0.607</span>, <span class="fl">0.599</span>, <span class="fl">0.591</span>, <span class="fl">0.583</span>, <span class="fl">0.575</span>, <span class="fl">0.567</span>, <span class="fl">0.559</span>, <span class="fl">0.551</span>, <span class="fl">0.543</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">maturity_BS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.013</span>, <span class="fl">0.013</span>, <span class="fl">0.013</span>, <span class="fl">0.013</span>, <span class="fl">0.014</span>, <span class="fl">0.014</span>, <span class="fl">0.016</span>, <span class="fl">0.018</span>, <span class="fl">0.021</span>, <span class="fl">0.024</span>,</span>
<span>  <span class="fl">0.030</span>, <span class="fl">0.037</span>, <span class="fl">0.045</span>, <span class="fl">0.054</span>, <span class="fl">0.066</span>, <span class="fl">0.079</span>, <span class="fl">0.093</span>, <span class="fl">0.108</span>, <span class="fl">0.124</span>, <span class="fl">0.139</span>,</span>
<span>  <span class="fl">0.154</span>, <span class="fl">0.169</span>, <span class="fl">0.182</span>, <span class="fl">0.195</span>, <span class="fl">0.208</span>, <span class="fl">0.220</span>, <span class="fl">0.232</span>, <span class="fl">0.243</span>, <span class="fl">0.255</span>, <span class="fl">0.266</span>,</span>
<span>  <span class="fl">0.276</span>, <span class="fl">0.286</span>, <span class="fl">0.294</span>, <span class="fl">0.302</span>, <span class="fl">0.308</span>, <span class="fl">0.314</span>, <span class="fl">0.319</span>, <span class="fl">0.323</span>, <span class="fl">0.327</span>, <span class="fl">0.331</span>,</span>
<span>  <span class="fl">0.334</span>, <span class="fl">0.338</span>, <span class="fl">0.341</span>, <span class="fl">0.345</span>, <span class="fl">0.349</span>, <span class="fl">0.353</span>, <span class="fl">0.358</span>, <span class="fl">0.364</span>, <span class="fl">0.370</span>, <span class="fl">0.370</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Shared selectivity-at-age vector (ages 3-52)</span></span>
<span><span class="va">selex_shared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.001</span>, <span class="fl">0.001</span>, <span class="fl">0.003</span>, <span class="fl">0.007</span>, <span class="fl">0.014</span>, <span class="fl">0.028</span>, <span class="fl">0.048</span>, <span class="fl">0.066</span>, <span class="fl">0.064</span>,</span>
<span>  <span class="fl">0.057</span>, <span class="fl">0.052</span>, <span class="fl">0.076</span>, <span class="fl">0.203</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span> <span class="op">-</span> <span class="fl">13</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Growth (von Bertalanffy parameters in cm)</span></span>
<span><span class="va">vb_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vb"</span>, Linf <span class="op">=</span> <span class="fl">54.4</span>, t0 <span class="op">=</span> <span class="op">-</span><span class="fl">0.36</span>, k <span class="op">=</span> <span class="fl">0.102</span><span class="op">)</span></span>
<span><span class="va">vb_BS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vb"</span>, Linf <span class="op">=</span> <span class="fl">52.6</span>, t0 <span class="op">=</span>  <span class="fl">0.20</span>, k <span class="op">=</span> <span class="fl">0.062</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weight-length parameters (W = alpha * L^beta)</span></span>
<span><span class="va">wl_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"wl"</span>, alpha <span class="op">=</span> <span class="fl">1.14e-5</span>, beta <span class="op">=</span> <span class="fl">3.098</span><span class="op">)</span></span>
<span><span class="va">wl_BS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"wl"</span>, alpha <span class="op">=</span> <span class="fl">8.13e-6</span>, beta <span class="op">=</span> <span class="fl">3.177</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="build-the-multispecies-spr_input-object">Build the multispecies <code>spr_input()</code> object<a class="anchor" aria-label="anchor" href="#build-the-multispecies-spr_input-object"></a>
</h3>
<p><code><a href="../reference/spr_input.html">spr_input()</a></code> stores all life history schedules required
by the per recruit model. For multispecies inputs, the object contains a
<code>species</code> list with one element per species.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spr_input.html">spr_input</a></span><span class="op">(</span></span>
<span>  ages <span class="op">=</span> <span class="va">ages</span>,</span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    RE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      len_at_age <span class="op">=</span> <span class="va">vb_RE</span>,</span>
<span>      wt_at_age <span class="op">=</span> <span class="va">wl_RE</span>,</span>
<span>      maturity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vector"</span>, m <span class="op">=</span> <span class="va">maturity_RE</span><span class="op">)</span>,</span>
<span>      selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vector"</span>, s <span class="op">=</span> <span class="va">selex_shared</span><span class="op">)</span>,</span>
<span>      M <span class="op">=</span> <span class="va">M_val</span></span>
<span>    <span class="op">)</span>,</span>
<span>    BS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      len_at_age <span class="op">=</span> <span class="va">vb_BS</span>,</span>
<span>      wt_at_age <span class="op">=</span> <span class="va">wl_BS</span>,</span>
<span>      maturity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vector"</span>, m <span class="op">=</span> <span class="va">maturity_BS</span><span class="op">)</span>,</span>
<span>      selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vector"</span>, s <span class="op">=</span> <span class="va">selex_shared</span><span class="op">)</span>,</span>
<span>      M <span class="op">=</span> <span class="va">M_val</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rec_prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>RE <span class="op">=</span> <span class="fl">0.5</span>, BS <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  use_plus_group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note: in a two species example, recruitment proportion sensitivities
will typically be implemented by storing baseline recruitment scaling as
<code>R0_base</code> for each species and then rescaling <code>R0</code>
inside <code><a href="../reference/spr_sensitivity.html">spr_sensitivity()</a></code>. In this vignette, we treat
<code>R0</code> as the recruitment scaling inside
<code><a href="../reference/spr_input.html">spr_input()</a></code> and vary those scalings through the sensitivity
function</p>
</div>
</div>
<div class="section level2">
<h2 id="check-inputs-before-running-reference-points">Check inputs before running reference points<a class="anchor" aria-label="anchor" href="#check-inputs-before-running-reference-points"></a>
</h2>
<p>Per recruit calculations are only as good as the implied schedules.
Before running reference points, it is useful to confirm that maturity,
selectivity, growth, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
align with the intended assumptions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inp_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_spr_inputs.html">plot_spr_inputs</a></span><span class="op">(</span></span>
<span>  <span class="va">inp</span>,</span>
<span>  panels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mat_selex"</span>, <span class="st">"wt"</span>, <span class="st">"len"</span>, <span class="st">"M"</span><span class="op">)</span>,</span>
<span>  overlay_maturity_selex <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">colour</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">colour</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">colour</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">colour</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">colour</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">colour</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">colour</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">colour</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="co"># inp_plots$mat_selex</span></span>
<span><span class="co"># inp_plots$wt</span></span>
<span><span class="co"># inp_plots$len</span></span>
<span><span class="co"># inp_plots$M</span></span>
<span></span>
<span><span class="co"># select a group of plots using optional helper function that relies on</span></span>
<span><span class="co"># the "patchwork" R library</span></span>
<span><span class="fu"><a href="../reference/grid_spr_inputs.html">grid_spr_inputs</a></span><span class="op">(</span><span class="va">inp_plots</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mat_selex"</span>, <span class="st">"wt"</span>,<span class="st">"len"</span>,<span class="st">"M"</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, guides <span class="op">=</span> <span class="st">"keep"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="672"></p>
<p>In this example, the maturity and selectivity panel is particularly
important. Selectivity is shared, but maturity differs strongly between
species.</p>
</div>
<div class="section level2">
<h2 id="run-per-recruit-spr-and-ypr-calculations">Run per recruit SPR and YPR calculations<a class="anchor" aria-label="anchor" href="#run-per-recruit-spr-and-ypr-calculations"></a>
</h2>
<p>We run the model in two modes:</p>
<ul>
<li>
<strong>Unconstrained</strong>
(<code>multispecies_constraint = "none"</code>), combined reference
points are based on the complex-level SPR curve.</li>
<li>
<strong>Constrained</strong>
(<code>multispecies_constraint = "all_species"</code>), combined
reference points are set to ensure every species meets the target SPR
and are therefore “constrained” to the limiting (i.e. lower
productivity) species.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spr_uncon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spr.html">run_spr</a></span><span class="op">(</span></span>
<span>  <span class="va">inp</span>,</span>
<span>  spr_targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>, </span>
<span>  multispecies_constraint <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">spr_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spr.html">run_spr</a></span><span class="op">(</span></span>
<span>  <span class="va">inp</span>,</span>
<span>  spr_targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  multispecies_constraint <span class="op">=</span> <span class="st">"all_species"</span>,</span>
<span>  diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">spr_uncon</span><span class="op">$</span><span class="va">F_spr_total</span></span>
<span><span class="co">#&gt; F40_total F35_total </span></span>
<span><span class="co">#&gt;     0.048     0.059</span></span>
<span><span class="va">spr_con</span><span class="op">$</span><span class="va">F_spr_total_constrained</span></span>
<span><span class="co">#&gt; F40_total_constrained F35_total_constrained </span></span>
<span><span class="co">#&gt;                 0.031                 0.036</span></span></code></pre></div>
<div class="section level3">
<h3 id="plot-spr-curves-with-reference-points">Plot SPR curves with reference points<a class="anchor" aria-label="anchor" href="#plot-spr-curves-with-reference-points"></a>
</h3>
<p>For multispecies complexes, the most informative total curve plot
shows the complex curve in black and the species curves in color. When
the constrained method is available, the plot also shows which species
is limiting the constrained reference point by placing a point on that
species curve at the constrained
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_spr_curves.html">plot_spr_curves</a></span><span class="op">(</span><span class="va">spr_con</span>, which <span class="op">=</span> <span class="st">"total"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="672"></p>
<p><strong>Interpretation:</strong> If one species has a much lower SPR
at a given F, then the constrained reference point is effectively
controlled by that species. In the RE/BS example, BS is the limiting
species because growth and maturity are slower, which reduces SBPR and
makes SPR decline faster for the same selectivity and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="species-specific-spr-curves-and-species-specific-reference-points">Species-specific SPR curves and species specific reference
points<a class="anchor" aria-label="anchor" href="#species-specific-spr-curves-and-species-specific-reference-points"></a>
</h3>
<p>The species view is useful when we need to connect complex-level
reference points to the implied species-level outcomes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_spr_curves.html">plot_spr_curves</a></span><span class="op">(</span><span class="va">spr_uncon</span>, which <span class="op">=</span> <span class="st">"species"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="decomposition-diagnostics-for-review-and-reporting">Decomposition diagnostics for review and reporting<a class="anchor" aria-label="anchor" href="#decomposition-diagnostics-for-review-and-reporting"></a>
</h2>
<p>Age-based decomposition plots help explain why SPR differs among
species by separating the effects of shared fishing processes from
species-specific life history. In this multispecies case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and selectivity are assumed to be the same for both species, so
differences in SPR arise from maturity schedules, growth, and the age
distribution of reproductive output.</p>
<p>When a plus group is used, the terminal age can dominate SBPR
contributions and removals. Dropping the plus group from the plotted
panels improves visibility of mid-age dynamics, while plus-group
importance is still reported in the caption and in
<code>spr_con$diagnostics$plus_share</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decomp_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_spr_decomp.html">plot_spr_decomp</a></span><span class="op">(</span></span>
<span>  <span class="va">spr_con</span>,</span>
<span>  which_panels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contrib"</span>, <span class="st">"removed"</span>, <span class="st">"removed_prop"</span>, <span class="st">"survivorship"</span><span class="op">)</span>,</span>
<span>  drop_plus_from_plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># default</span></span>
<span>  include_plus_caption <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># default</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## individual plots</span></span>
<span><span class="co"># decomp_plots$contrib</span></span>
<span><span class="co"># decomp_plots$removed</span></span>
<span><span class="co"># decomp_plots$removed_prop</span></span>
<span><span class="co"># decomp_plots$survivorship</span></span>
<span></span>
<span><span class="co"># select a group of plots using optional helper function that relies on the</span></span>
<span><span class="co"># "patchwork" R library</span></span>
<span><span class="fu"><a href="../reference/grid_spr_decomp.html">grid_spr_decomp</a></span><span class="op">(</span><span class="va">decomp_plots</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contrib"</span>, <span class="st">"survivorship"</span><span class="op">)</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/decomp-1.png" class="r-plt" alt="" width="672"></p>
<p><strong>Interpretation:</strong> The decomposition diagnostics show
that differences in multispecies SPR for RE/BS are driven by life
history timing, not by differences in fishing or survivorship processes.
Later maturation and slower accumulation of reproductive biomass cause
blackspotted rockfish to lose SPR more rapidly as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
increases, explaining why it is the limiting species under constrained
multispecies Tier 4 reference points.</p>
<ul>
<li><p><strong>SBPR contribution by age:</strong> Under unfished
conditions
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mn>0</mn></msub><annotation encoding="application/x-tex">F_0</annotation></semantics></math>),
rougheye rockfish contribute SBPR earlier and across a broader range of
ages, reflecting faster maturity and growth rates. In contrast,
blackspotted rockfish contribute relatively little SBPR at younger ages
and rely more heavily on survival to older ages to generate spawning
biomass. These differences are driven by later maturation and slower
growth in blackspotted rockfish, not by differences in fishing pressure
or survivorship processes.</p></li>
<li><p><strong>Survivorship by age:</strong> Survivorship curves are
nearly identical between species at both F0 and Ftarget, confirming that
differences in SPR are not driven by differential mortality processes.
Instead, survivorship interacts with species-specific maturity and
weight-at-age schedules to determine how much spawning biomass survives
to older ages. For blackspotted rockfish, modest reductions in
survivorship at older ages translate into large proportional losses in
reproductive output.</p></li>
<li><p><strong>Role of the plus group:</strong> Plus-group share
diagnostics show that a substantial fraction of blackspotted rockfish
SBPR is generated in the terminal age under unfished conditions, and
that this fraction declines sharply at the reference
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>.
Rougheye rockfish, by contrast, distribute reproductive output more
evenly across ages. This reliance on late-life reproduction makes
blackspotted rockfish particularly sensitive to age truncation, even
under shared selectivity and mortality assumptions.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/grid_spr_decomp.html">grid_spr_decomp</a></span><span class="op">(</span><span class="va">decomp_plots</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"removed"</span>, <span class="st">"removed_prop"</span><span class="op">)</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/decomp_removals-1.png" class="r-plt" alt="" width="672"></p>
<ul>
<li><p><strong>SBPR removed by fishing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>0</mn></msub><mo>−</mo><msub><mi>F</mi><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_0 − F_{target}</annotation></semantics></math>):</strong>
Because rougheye has higher SBPR contributions across much of the age
range, it results in larger absolute SBPR removals even under identical
selectivity and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>.</p></li>
<li><p><strong>Proportion SBPR removed:</strong> Expressing removals
relative to unfished SBPR clarifies why blackspotted rockfish is the
limiting species under constrained reference points. Proportional losses
accumulate more rapidly once fishing affects the ages where blackspotted
concentrates its reproductive output. This metric better reflects SPR
sensitivity than absolute removals alone.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="sensitivity-to-recruitment-proportions-and-reference-point-definition">Sensitivity to recruitment proportions and reference point
definition<a class="anchor" aria-label="anchor" href="#sensitivity-to-recruitment-proportions-and-reference-point-definition"></a>
</h2>
<div class="section level3">
<h3 id="recruitment-proportions">Recruitment proportions<a class="anchor" aria-label="anchor" href="#recruitment-proportions"></a>
</h3>
<p>Recruitment proportions affect the complex-level SPR curve because
total SBPR is defined as the sum of the species-specific SBPR
contributions. As the recruitment proportion assigned to one species
increases, the complex curve becomes more similar to that species
curve.</p>
<p>Recruitment proportion sensitivity is only implemented for
<strong>two species complexes</strong>, because it is defined as a
single proportion <code>prop</code> assigned to the first species, and
the second species receives <code>1 - prop</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># unconstrained</span></span>
<span><span class="va">sens_uncon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spr_sensitivity.html">spr_sensitivity</a></span><span class="op">(</span></span>
<span>  x_base <span class="op">=</span> <span class="va">inp</span>,</span>
<span>  prop <span class="op">=</span> <span class="va">prop_grid</span>,</span>
<span>  spr_targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  multispecies_constraint <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; spr_sensitivity(): Sweep values are applied to all species simultaneously. Species-specific sweeps are not currently supported.</span></span>
<span></span>
<span><span class="co"># constrained</span></span>
<span><span class="va">sens_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spr_sensitivity.html">spr_sensitivity</a></span><span class="op">(</span></span>
<span>  x_base <span class="op">=</span> <span class="va">inp</span>,</span>
<span>  prop <span class="op">=</span> <span class="va">prop_grid</span>,</span>
<span>  spr_targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  multispecies_constraint <span class="op">=</span> <span class="st">"all_species"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; spr_sensitivity(): Sweep values are applied to all species simultaneously. Species-specific sweeps are not currently supported.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-reference-point-sensitivity-across-recruitment-proportions">Plot reference point sensitivity across recruitment proportions<a class="anchor" aria-label="anchor" href="#plot-reference-point-sensitivity-across-recruitment-proportions"></a>
</h3>
<p>The default plot summarizes results in a single panel, colors by SPR
target, and uses linetype to distinguish unconstrained versus
constrained reference points</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_recprop_sensitivity.html">plot_recprop_sensitivity</a></span><span class="op">(</span></span>
<span>  sens_uncon <span class="op">=</span> <span class="va">sens_uncon</span>,</span>
<span>  sens_con <span class="op">=</span> <span class="va">sens_con</span>,</span>
<span>  targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"RE/BS complex: reference point sensitivity to recruitment proportions"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p_ref</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/recprop_sensitivity-1.png" class="r-plt" alt="" width="672"></p>
<p><strong>Interpretation</strong>: Under the constrained rule,
reference points are determined entirely by the species with the lowest
SPR at a given fishing mortality. Because species-specific SPR curves
are independent of recruitment proportions, constrained reference points
remain constant across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
proprotion scenarios, while unconstrained reference points vary as the
relative contribution of each species to total SBPR changes.</p>
</div>
<div class="section level3">
<h3 id="optional-yield-share-at-reference-points">Optional: yield share at reference points<a class="anchor" aria-label="anchor" href="#optional-yield-share-at-reference-points"></a>
</h3>
<p>Recruitment proportions also control how much of the complex YPR
comes from each species under equilibrium conditions. A common
management question is, under a given recruitment proportion and
reference point definition, what fraction of yield is implied for each
species.</p>
<p><code><a href="../reference/plot_recprop_sensitivity.html">plot_recprop_sensitivity()</a></code> can optionally return or plot
yield share at the reference points. This vignette focuses on yield
share at the reference points, not full YPR curves versus F.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_yshare</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_recprop_sensitivity.html">plot_recprop_sensitivity</a></span><span class="op">(</span></span>
<span>  sens_uncon <span class="op">=</span> <span class="va">sens_uncon</span>,</span>
<span>  sens_con <span class="op">=</span> <span class="va">sens_con</span>,</span>
<span>  targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  include_yield_share <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"RE/BS complex: implied yield share at reference points"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p_yshare</span><span class="op">$</span><span class="va">yield_share</span> <span class="co"># also includes the main recprop plot shown above</span></span></code></pre></div>
<p><img src="rebs_multispecies_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="672"><strong>Interpretation:</strong> Yield-share diagnostics show the
fraction of total equilibrium YPR contributed by each species at the
SPR-based reference points. Yield share varies smoothly with recruitment
composition and is largely insensitive to whether constrained or
unconstrained reference points are used, indicating that relative yield
composition is robust to small differences
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mi>P</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">F_{SPR}</annotation></semantics></math>
reference points.</p>
<p>Under the default 50/50 recruitment assumption, rougheye rockfish
contribute a majority of the equilibrium yield despite blackspotted
rockfish being the limiting species for constrained reference points.
This contrast highlights a central feature of multispecies Tier 4
assessments: the species that limits
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mi>P</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">F_{SPR}</annotation></semantics></math>
need not be the species that dominates yield.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrates a complete multispecies Tier 4 SBPR
workflow using <strong>tier4tools</strong>:</p>
<ul>
<li>Build a multispecies <code><a href="../reference/spr_input.html">spr_input()</a></code> object and verify
schedules using <code><a href="../reference/plot_spr_inputs.html">plot_spr_inputs()</a></code>
</li>
<li>Compute unconstrained and constrained multispecies reference points
with <code><a href="../reference/run_spr.html">run_spr()</a></code>
</li>
<li>Use decomposition plots to understand why species differ in SPR
response to fishing</li>
<li>Conduct recruitment proportion sensitivity for a two species complex
and interpret why constrained reference points are insensitive to
recruitment proportions</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jane Sullivan, Kristen Omori.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
