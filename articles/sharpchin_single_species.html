<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Single species workflow: Gulf of Alaska sharpchin rockfish • tier4tools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single species workflow: Gulf of Alaska sharpchin rockfish">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tier4tools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Single species workflow: Gulf of Alaska sharpchin rockfish</h1>
            
      

      <div class="d-none name"><code>sharpchin_single_species.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-objectives">Background and objectives<a class="anchor" aria-label="anchor" href="#background-and-objectives"></a>
</h2>
<p>Sharpchin rockfish (<em>Sebastes zacentrus</em>) in the Gulf of
Alaska is caught as a non-target species and has limited age and fishery
data. Sharpchin is currently the only Alaska groundfish species managed
under a Tier 4 assessment framework, and provides a useful example of
how spawning potential ratio (SPR) and yield-per-recruit (YPR) methods
can be applied when age-structured models are not feasible.</p>
<p>This vignette demonstrates the full Tier 4 per-recruit workflow
implemented in <strong>tier4tools</strong> using Gulf of Alaska
sharpchin rockfish as a single-species example. The objectives are
to:</p>
<ul>
<li>Construct per-recruit inputs using published and assessment-derived
life history information using <code>spr_inputs()</code>.</li>
<li>Validate inputs visually using <code><a href="../reference/plot_spr_inputs.html">plot_spr_inputs()</a></code>.</li>
<li>Compute SPR-based fishing mortality reference points using
<code><a href="../reference/run_spr.html">run_spr()</a></code>.</li>
<li>Generate diagnostic decomposition plots for review and SAFE
reporting using <code><a href="../reference/plot_spr_decomp.html">plot_spr_decomp()</a></code>.</li>
<li>Evaluate sensitivity of reference points to uncertainty in natural
mortality
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>)
fishery selectivity using <code><a href="../reference/spr_sensitivity.html">spr_sensitivity()</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="life-history-and-fishery-inputs">Life history and fishery inputs<a class="anchor" aria-label="anchor" href="#life-history-and-fishery-inputs"></a>
</h2>
<p>Biological inputs for sharpchin rockfish were drawn from published
studies and assessment documentation, including von Bertalanffy growth
parameters, weight-length relationships derived from trawl survey data,
maturity-at-age estimates, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
estimated using the Hoenig (1983) method. Fishery selectivity is poorly
informed due to limited sampling and is therefore assumed to follow a
knife-edge pattern.</p>
<p>For the base case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>0.059</mn></mrow><annotation encoding="application/x-tex">M = 0.059</annotation></semantics></math>,
maturity is parameterized using a logistic maturity curve with midpoint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>50</mn></msub><mo>=</mo><mn>10.06</mn></mrow><annotation encoding="application/x-tex">A_{50} = 10.06</annotation></semantics></math>
years and slope parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mo>−</mo><mn>1.96</mn></mrow><annotation encoding="application/x-tex">\delta = -1.96</annotation></semantics></math>.
Fishery selectivity is assumed to be knife-edge with full selection
beginning at age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>c</mi></msub><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">a_c = 10</annotation></semantics></math>
years. A maximum age of 58 years is assumed, and here we assume no plus
group.</p>
</div>
<div class="section level2">
<h2 id="construct-per-recruit-inputs-with-spr_input">Construct per-recruit inputs with <code>spr_input()</code><a class="anchor" aria-label="anchor" href="#construct-per-recruit-inputs-with-spr_input"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tier4tools</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span></span>
<span></span>
<span><span class="va">inp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spr_input.html">spr_input</a></span><span class="op">(</span></span>
<span>  ages <span class="op">=</span> <span class="va">ages</span>,</span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Sharpchin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      len_at_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"vb"</span>, Linf <span class="op">=</span> <span class="fl">35.02</span>, k <span class="op">=</span> <span class="fl">0.122</span>, t0 <span class="op">=</span> <span class="op">-</span><span class="fl">0.75</span><span class="op">)</span>,</span>
<span>      wt_at_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"wl"</span>, alpha <span class="op">=</span> <span class="fl">1.19e-5</span>, beta <span class="op">=</span> <span class="fl">3.056</span><span class="op">)</span>,</span>
<span>      maturity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"logistic"</span>, a50 <span class="op">=</span> <span class="fl">10.06</span>, delta <span class="op">=</span> <span class="op">-</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>      selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"knife_edge"</span>, a_c <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      M <span class="op">=</span> <span class="fl">0.059</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  use_plus_group <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">inp</span>, max.level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ ages          : num [1:101] 0 1 2 3 4 5 6 7 8 9 ...</span></span>
<span><span class="co">#&gt;  $ R0            : num 1</span></span>
<span><span class="co">#&gt;  $ use_plus_group: logi FALSE</span></span>
<span><span class="co">#&gt;  $ rec_prop      : Named num 1</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr "Sharpchin"</span></span>
<span><span class="co">#&gt;  $ species       :List of 1</span></span>
<span><span class="co">#&gt;   ..$ Sharpchin:List of 11</span></span>
<span><span class="co">#&gt;   .. ..$ name           : chr "Sharpchin"</span></span>
<span><span class="co">#&gt;   .. ..$ R0_base        : num 1</span></span>
<span><span class="co">#&gt;   .. ..$ R0             : num 1</span></span>
<span><span class="co">#&gt;   .. ..$ M_at_age       : num [1:101] 0.059 0.059 0.059 0.059 0.059 0.059 0.059 0.059 0.059 0.059 ...</span></span>
<span><span class="co">#&gt;   .. ..$ len_at_age     : num [1:101] 3.06 6.73 9.98 12.86 15.4 ...</span></span>
<span><span class="co">#&gt;   .. ..$ wt_at_age      : num [1:101] 0.000364 0.004041 0.013461 0.02918 0.050679 ...</span></span>
<span><span class="co">#&gt;   .. ..$ maturity_at_age: num [1:101] 0.00587 0.00973 0.01611 0.02654 0.04345 ...</span></span>
<span><span class="co">#&gt;   .. ..$ selex_at_age   : num [1:101] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   .. ..$ maturity_delta : num -1.96</span></span>
<span><span class="co">#&gt;   .. ..$ maturity_spec  :List of 3</span></span>
<span><span class="co">#&gt;   .. ..$ spec           :List of 5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="validate-assumptions-visually-with-plot_spr_inputs">Validate assumptions visually with
<code>plot_spr_inputs()</code><a class="anchor" aria-label="anchor" href="#validate-assumptions-visually-with-plot_spr_inputs"></a>
</h2>
<p>Before running SPR calculations, it is good practice to check that
the implied schedules look reasonable. <code><a href="../reference/plot_spr_inputs.html">plot_spr_inputs()</a></code> is
designed for two use cases:</p>
<ul>
<li>user quality assurance, to verify maturity, selectivity,
weight-at-age, and mortality schedules were parameterized and input
correctly</li>
<li>reporting, to document base case versus sensitivity assumptions, or
differences among species</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inp_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_spr_inputs.html">plot_spr_inputs</a></span><span class="op">(</span><span class="va">inp</span>, panels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mat_selex"</span>, <span class="st">"wt"</span>, <span class="st">"len"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## inidividual plots</span></span>
<span><span class="co"># inp_plots$mat_selex</span></span>
<span><span class="co"># inp_plots$wt</span></span>
<span><span class="co"># inp_plots$len</span></span>
<span><span class="co"># inp_plots$M</span></span>
<span></span>
<span><span class="co"># select a group of plots using optional helper function that relies on</span></span>
<span><span class="co"># the "patchwork" R library</span></span>
<span><span class="fu"><a href="../reference/grid_spr_inputs.html">grid_spr_inputs</a></span><span class="op">(</span><span class="va">inp_plots</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mat_selex"</span>, <span class="st">"wt"</span>,<span class="st">"len"</span>,<span class="st">"M"</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, guides <span class="op">=</span> <span class="st">"keep"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sharpchin_single_species_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="672"></p>
<p>If you are comparing scenarios in a sensitivity analysis, you can
pass multiple <code><a href="../reference/spr_input.html">spr_input()</a></code> objects via <code>compare</code>
and facet by scenario:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example (**code only shown, not run**): construct additional spr_input</span></span>
<span><span class="co"># objects, either from scratch or by modifying existing input objects as shown</span></span>
<span><span class="co"># below using public-facing functions like selectivity_at_age(),</span></span>
<span><span class="co"># maturity_at_age(), wt_at_age(), or len_at_age()</span></span>
<span></span>
<span><span class="co"># sensitivity 1 (knife-edge selectivity with max selectivity at age 5)</span></span>
<span><span class="va">inp_sens1</span> <span class="op">&lt;-</span> <span class="va">inp</span> </span>
<span><span class="va">inp_sens1</span><span class="op">$</span><span class="va">species</span><span class="op">$</span><span class="va">Sharpchin</span><span class="op">$</span><span class="va">selex_at_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectivity_at_age.html">selectivity_at_age</a></span><span class="op">(</span>ages <span class="op">=</span> <span class="va">inp</span><span class="op">$</span><span class="va">ages</span>, selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"knife_edge"</span>, a_c <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sensitivity 2 (knife-edge selectivity with max selectivity at age 5)</span></span>
<span><span class="va">inp_sens2</span> <span class="op">&lt;-</span> <span class="va">inp</span> </span>
<span><span class="va">inp_sens2</span><span class="op">$</span><span class="va">species</span><span class="op">$</span><span class="va">Sharpchin</span><span class="op">$</span><span class="va">selex_at_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selectivity_at_age.html">selectivity_at_age</a></span><span class="op">(</span>ages <span class="op">=</span> <span class="va">inp</span><span class="op">$</span><span class="va">ages</span>, selectivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"knife_edge"</span>, a_c <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show base + sensitivities</span></span>
<span><span class="va">inp_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_spr_inputs.html">plot_spr_inputs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">inp</span>, compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sens1 <span class="op">=</span> <span class="va">inp_sens1</span>, Sens2 <span class="op">=</span> <span class="va">inp_sens2</span><span class="op">)</span>, <span class="op">)</span></span>
<span><span class="va">inp_plots</span><span class="op">$</span><span class="va">mat_selex</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-per-recruit-spr-and-ypr-with-run_spr">Run per-recruit SPR and YPR with <code>run_spr()</code><a class="anchor" aria-label="anchor" href="#run-per-recruit-spr-and-ypr-with-run_spr"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spr.html">run_spr</a></span><span class="op">(</span></span>
<span>  <span class="va">inp</span>,</span>
<span>  diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">spr_out</span><span class="op">$</span><span class="va">F_spr_total</span></span>
<span><span class="co">#&gt; F40_total F35_total </span></span>
<span><span class="co">#&gt;     0.066     0.080</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-spr-curves">Plot SPR curves<a class="anchor" aria-label="anchor" href="#plot-spr-curves"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_spr_curves.html">plot_spr_curves</a></span><span class="op">(</span><span class="va">spr_out</span><span class="op">)</span></span></code></pre></div>
<p><img src="sharpchin_single_species_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="672"></p>
<p>The curve shows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>P</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>S</mi><mi>B</mi><mi>P</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>S</mi><mi>B</mi><mi>P</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">SPR(F) = SBPR(F) / SBPR(0)</annotation></semantics></math>
across the fishing mortality grid. Horizontal lines show the target SPR
levels (for example 0.40 and 0.35). The corresponding fishing mortality
reference points (for example
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>40</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{40\%}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>35</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{35\%}</annotation></semantics></math>)
are the values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
where the curve intersects the targets.</p>
</div>
<div class="section level2">
<h2 id="diagnostic-decomposition-plots">Diagnostic decomposition plots<a class="anchor" aria-label="anchor" href="#diagnostic-decomposition-plots"></a>
</h2>
<p>Tier 4 SPR calculations can be sensitive to maturity schedules,
selectivity assumptions, weight-at-age, and plus group treatment. To
support consistent review and reporting, <strong>tier4tools</strong>
provides SBPR age decomposition diagnostics as a set of standardized
panels.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_spr_decomp.html">plot_spr_decomp</a></span><span class="op">(</span><span class="va">spr_out</span>,</span>
<span>                         which_panels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contrib"</span>, <span class="st">"removed"</span>, <span class="st">"survivorship"</span><span class="op">)</span>,</span>
<span>                         drop_plus_from_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## individual plots</span></span>
<span><span class="co"># plots$contrib</span></span>
<span><span class="co"># plots$removed</span></span>
<span><span class="co"># plots$survivorship</span></span>
<span></span>
<span><span class="co"># select a group of plots using optional helper function that relies on</span></span>
<span><span class="co"># the "patchwork" R library</span></span>
<span><span class="fu"><a href="../reference/grid_spr_decomp.html">grid_spr_decomp</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span></span></code></pre></div>
<p><img src="sharpchin_single_species_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="672"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<code>plots$contrib</code> shows SBPR contribution by age for
unfished conditions (F = 0) and at the diagnostic reference fishing
mortality (<code>Ftarget</code>).</li>
<li>
<code>plots$removed</code> shows the age-specific SBPR removed by
fishing, computed as contribution at F = 0 minus contribution at
<code>Ftarget</code>.</li>
<li>
<code>plots$survivorship</code> shows per-recruit survivorship under
F = 0 and <code>Ftarget</code>.</li>
</ul>
<p>The plus group share is reported separately as the fraction of total
SBPR contributed by the terminal age at F = 0 and <code>Ftarget</code>.
Here we assume no plus group calculations in the model; therefore, the
plus-share is almost non-existent.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spr_out</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">plus_share</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sensitivity-analysis-natural-mortality-m-and-selectivity">Sensitivity analysis: natural mortality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and selectivity<a class="anchor" aria-label="anchor" href="#sensitivity-analysis-natural-mortality-m-and-selectivity"></a>
</h2>
<p>Uncertainty in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and fishery selectivity is a key concern for sharpchin rockfish. Here we
run a structured sensitivity analysis varying:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
from 0.05 to 0.12</li>
<li>knife-edge selectivity age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>c</mi></msub><annotation encoding="application/x-tex">a_c</annotation></semantics></math>
from 5 to 15 years</li>
</ul>
<p>All other inputs are held fixed.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spr_sensitivity.html">spr_sensitivity</a></span><span class="op">(</span></span>
<span>  <span class="va">inp</span>,</span>
<span>  M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.12</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  selex_ac <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  spr_targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  multispecies_constraint <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sens</span><span class="op">)</span></span>
<span><span class="co">#&gt;   scenario_id    M maturity_a50 selex_ac prop F40_total F35_total</span></span>
<span><span class="co">#&gt; 1           1   NA           NA       NA   NA     0.066     0.080</span></span>
<span><span class="co">#&gt; 2           2 0.05           NA       NA   NA     0.058     0.070</span></span>
<span><span class="co">#&gt; 3           3 0.06           NA       NA   NA     0.066     0.082</span></span>
<span><span class="co">#&gt; 4           4 0.07           NA       NA   NA     0.078     0.094</span></span>
<span><span class="co">#&gt; 5           5 0.08           NA       NA   NA     0.088     0.108</span></span>
<span><span class="co">#&gt; 6           6 0.09           NA       NA   NA     0.100     0.122</span></span>
<span><span class="co">#&gt;   F40_total_constrained F35_total_constrained YPR_at_F40</span></span>
<span><span class="co">#&gt; 1                    NA                    NA 0.11651216</span></span>
<span><span class="co">#&gt; 2                    NA                    NA 0.13460304</span></span>
<span><span class="co">#&gt; 3                    NA                    NA 0.11420131</span></span>
<span><span class="co">#&gt; 4                    NA                    NA 0.09968137</span></span>
<span><span class="co">#&gt; 5                    NA                    NA 0.08669596</span></span>
<span><span class="co">#&gt; 6                    NA                    NA 0.07630796</span></span>
<span><span class="co">#&gt;   plus_share_Sharpchin_F0 plus_share_Sharpchin_Ftarget F40_Sharpchin</span></span>
<span><span class="co">#&gt; 1                      NA                           NA         0.066</span></span>
<span><span class="co">#&gt; 2                      NA                           NA         0.058</span></span>
<span><span class="co">#&gt; 3                      NA                           NA         0.066</span></span>
<span><span class="co">#&gt; 4                      NA                           NA         0.078</span></span>
<span><span class="co">#&gt; 5                      NA                           NA         0.088</span></span>
<span><span class="co">#&gt; 6                      NA                           NA         0.100</span></span>
<span><span class="co">#&gt;   F35_Sharpchin YPR40_Sharpchin share40_Sharpchin YPR40_total</span></span>
<span><span class="co">#&gt; 1         0.080      0.11651216                 1  0.11651216</span></span>
<span><span class="co">#&gt; 2         0.070      0.13460304                 1  0.13460304</span></span>
<span><span class="co">#&gt; 3         0.082      0.11420131                 1  0.11420131</span></span>
<span><span class="co">#&gt; 4         0.094      0.09968137                 1  0.09968137</span></span>
<span><span class="co">#&gt; 5         0.108      0.08669596                 1  0.08669596</span></span>
<span><span class="co">#&gt; 6         0.122      0.07630796                 1  0.07630796</span></span>
<span><span class="co">#&gt;   YPR40_Sharpchin_constrained share40_Sharpchin_constrained</span></span>
<span><span class="co">#&gt; 1                          NA                            NA</span></span>
<span><span class="co">#&gt; 2                          NA                            NA</span></span>
<span><span class="co">#&gt; 3                          NA                            NA</span></span>
<span><span class="co">#&gt; 4                          NA                            NA</span></span>
<span><span class="co">#&gt; 5                          NA                            NA</span></span>
<span><span class="co">#&gt; 6                          NA                            NA</span></span>
<span><span class="co">#&gt;   YPR40_total_constrained YPR35_Sharpchin share35_Sharpchin YPR35_total</span></span>
<span><span class="co">#&gt; 1                      NA      0.12353530                 1  0.12353530</span></span>
<span><span class="co">#&gt; 2                      NA      0.14233674                 1  0.14233674</span></span>
<span><span class="co">#&gt; 3                      NA      0.12202936                 1  0.12202936</span></span>
<span><span class="co">#&gt; 4                      NA      0.10551203                 1  0.10551203</span></span>
<span><span class="co">#&gt; 5                      NA      0.09230489                 1  0.09230489</span></span>
<span><span class="co">#&gt; 6                      NA      0.08108499                 1  0.08108499</span></span>
<span><span class="co">#&gt;   YPR35_Sharpchin_constrained share35_Sharpchin_constrained</span></span>
<span><span class="co">#&gt; 1                          NA                            NA</span></span>
<span><span class="co">#&gt; 2                          NA                            NA</span></span>
<span><span class="co">#&gt; 3                          NA                            NA</span></span>
<span><span class="co">#&gt; 4                          NA                            NA</span></span>
<span><span class="co">#&gt; 5                          NA                            NA</span></span>
<span><span class="co">#&gt; 6                          NA                            NA</span></span>
<span><span class="co">#&gt;   YPR35_total_constrained             scenario_label M_value maturity_a50_value</span></span>
<span><span class="co">#&gt; 1                      NA  M=base, a50=base, ac=base   0.059              10.06</span></span>
<span><span class="co">#&gt; 2                      NA M=0.050, a50=base, ac=base   0.050              10.06</span></span>
<span><span class="co">#&gt; 3                      NA M=0.060, a50=base, ac=base   0.060              10.06</span></span>
<span><span class="co">#&gt; 4                      NA M=0.070, a50=base, ac=base   0.070              10.06</span></span>
<span><span class="co">#&gt; 5                      NA M=0.080, a50=base, ac=base   0.080              10.06</span></span>
<span><span class="co">#&gt; 6                      NA M=0.090, a50=base, ac=base   0.090              10.06</span></span>
<span><span class="co">#&gt;   selex_ac_value prop_value</span></span>
<span><span class="co">#&gt; 1             10         NA</span></span>
<span><span class="co">#&gt; 2             10         NA</span></span>
<span><span class="co">#&gt; 3             10         NA</span></span>
<span><span class="co">#&gt; 4             10         NA</span></span>
<span><span class="co">#&gt; 5             10         NA</span></span>
<span><span class="co">#&gt; 6             10         NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-sensitivity-results">Visualize sensitivity results<a class="anchor" aria-label="anchor" href="#visualize-sensitivity-results"></a>
</h2>
<p>Heatmaps are a compact way to summarize how reference points vary
across a structured grid of assumptions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sensitivity_heatmap.html">plot_sensitivity_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">sens</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"selex_ac"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"F40_total"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Sensitivity of F40 to M and selectivity assumptions"</span>,</span>
<span>  fill_scale <span class="op">=</span> <span class="st">"viridis"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="sharpchin_single_species_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="672"></p>
<p>You can similarly visualize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mn>35</mn></msub><annotation encoding="application/x-tex">F_{35}</annotation></semantics></math>
or yield at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mn>40</mn></msub><annotation encoding="application/x-tex">F_{40}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sensitivity_heatmap.html">plot_sensitivity_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">sens</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"selex_ac"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"F35_total"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Sensitivity of F35 to natural mortality and selectivity assumptions"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="sharpchin_single_species_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_sensitivity_heatmap.html">plot_sensitivity_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">sens</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"selex_ac"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"YPR_at_F40"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Sensitivity of YPR at F40 to natural mortality and selectivity assumptions"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="sharpchin_single_species_files/figure-html/unnamed-chunk-10-2.png" class="r-plt" alt="" width="672"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>Fishery selectivity and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
are both dominant sources of uncertainty in SPR-based reference points,
with later age at full selection and higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
resulting in higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>40</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{40\%}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>35</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{35\%}</annotation></semantics></math>.</li>
<li>At low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
values, including the base-case M=0.059, and early selectivity,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>40</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{40\%}</annotation></semantics></math>
was uniformly low and relatively insensitive to either parameter. In
contrast, at higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and later selectivity, small changes in either assumption produced large
shifts in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>40</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{40\%}</annotation></semantics></math>.</li>
<li>YPR evaluated at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mn>40</mn><mi>%</mi></mrow></msub><annotation encoding="application/x-tex">F_{40\%}</annotation></semantics></math>
increases with later selectivity and decreases with higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>,
reflecting differences in the SPR-constrained
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
rather than YPR at a fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrates a complete Tier 4 per-recruit workflow for
a single species using <strong>tier4tools</strong>. The workflow
separates biological and fishery assumptions from downstream
calculations, provides standardized diagnostics and plotting helpers,
and supports structured sensitivity evaluation of influential
uncertainties.</p>
<p>In the multispecies vignette, the same workflow is extended to stock
complexes and additional outputs are introduced for constrained
reference points.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jane Y. Sullivan, Kristen L. Omori.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
